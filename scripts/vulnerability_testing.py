import subprocess
from pathlib import Path
from rich.console import Console

OUTPUT_DIR = Path("output")

def run_tests():
    console = Console()
    console.print("[title]ðŸ’¥ Running vulnerability tests...[/title]")
    tests = [
        ("dalfox", "xss", "xss_results.txt"),
        ("sqlmap", "sqli", "sqli_results.txt"),
        ("commix", "ssrf", "ssrf_results.txt")
    ]
    for tool, vuln_type, output_file in tests:
        urls_file = OUTPUT_DIR / "categorized_urls" / f"{vuln_type}.txt"
        payloads_file = OUTPUT_DIR / "payloads" / f"{vuln_type}_payloads.txt"
        results_file = OUTPUT_DIR / "testing_results" / output_file
        command = f"{tool} -u {urls_file} -p {payloads_file} -o {results_file}"
        console.print(f"[info]Running {tool} for {vuln_type}...[/info]")
        subprocess.run(command, shell=True)
    console.print("[success]Vulnerability testing completed! ðŸŽ‰[/success]")