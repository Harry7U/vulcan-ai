from pathlib import Path
from rich.console import Console

OUTPUT_DIR = Path("output")

def categorize_urls():
    console = Console()
    console.print("[title]ðŸ“‚ Categorizing URLs...[/title]")
    categories = {
        "xss": [],
        "sqli": [],
        "ssrf": []
    }
    with open(OUTPUT_DIR / "collected_urls.txt", "r") as f:
        urls = f.read().splitlines()
    for url in urls:
        if "xss" in url:
            categories["xss"].append(url)
        if "sqli" in url:
            categories["sqli"].append(url)
        if "ssrf" in url:
            categories["ssrf"].append(url)
    OUTPUT_DIR.mkdir(parents=True, exist_ok=True)
    for category, urls in categories.items():
        with open(OUTPUT_DIR / "categorized_urls" / f"{category}.txt", "w") as f:
            for url in urls:
                f.write(url + '\n')
    console.print("[success]URL categorization completed! ðŸŽ‰[/success]")